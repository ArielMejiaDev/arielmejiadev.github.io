{"_path":"/blog/8-use-laravel-route-model-binding-into-middlewares","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Use route model binding on Middlewares in Laravel","description":"How do you handle a route model binding on Middleware","id":8,"published":true,"date":"July 18th, 2020","cover_image":"https://dev-to-uploads.s3.amazonaws.com/i/2gkj91aqrqtznh945eo7.png","tags":["Laravel"],"announcement_banner":null,"announcement_link":null,"readingTime":{"text":"1 min read","minutes":0.825,"time":49500,"words":165},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Route Model Binding"}]},{"type":"text","value":" is a feature that allows the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Laravel"}]},{"type":"text","value":" Container\nto resolve a "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"model"}]},{"type":"text","value":" instance by a route param automatically."}]},{"type":"element","tag":"h2","props":{"id":"create-a-middleware"},"children":[{"type":"text","value":"Create a middleware"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"php artisan make:middleware UserMiddleware\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"php"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"artisan"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"make:middleware"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"UserMiddleware"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For the sake of simplicity in this example we are going to check if the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"user"}]},{"type":"text","value":" has a specific name,\nif not it will redirect back with a status "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"flash message"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In directory "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"App/Http/Middleware"}]}]},{"type":"element","tag":"pre","props":{"className":"language-php dracula","code":"public function handle($request, Closure $next)\n{\n    // 1 way to get the model from route model binding\n    //$condition = Route::current()->parameters()->name === 'John Doe';\n\n    // 2 way to get the model from route model binding\n    //$condition = $request->name === 'John Doe'\n\n    // 3 way to get the model from route model binding\n    $condition = $request->route('user')->name === 'John Doe';\n\n    if ($condition) \n    {\n         return redirect()\n             ->back()\n             ->with('status', 'user is not the admin');\n    }\n    return $next($request);\n}\n","language":"php","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"handle"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"($request, "}]},{"type":"element","tag":"span","props":{"class":"ct-432594"},"children":[{"type":"text","value":"Closure"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" $next)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"// 1 way to get the model from route model binding\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"//$condition = Route::current()->parameters()->name === 'John Doe';\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"// 2 way to get the model from route model binding\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"//$condition = $request->name === 'John Doe'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"// 3 way to get the model from route model binding\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    $condition "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" $request"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"->"}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"route"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"user"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"->"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"name "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"John Doe"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" ($condition) \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"         "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"redirect"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"             "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"->"}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"back"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"             "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"->"}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"status"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"user is not the admin"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" $next($request);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"element","tag":"hr","props":{"id":""},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Route model binding"}]},{"type":"text","value":" only works if route has the model param "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"/{user}"}]},{"type":"text","value":" and both names matches"}]},{"type":"element","tag":"hr","props":{"id":"_1"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to use a custom param name "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Laravel"}]},{"type":"text","value":" provides different ways\nto customize "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"route model binding"}]},{"type":"text","value":" the easiest way is to add the method "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"params(['user' => 'customParam'])"}]},{"type":"text","value":" to the current route"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Thanks for reading!"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":".dracula{color:#F8F8F2;background:#282A36;}.ct-711500{color:#50FA7B;}.ct-183901{color:#F8F8F2;}.ct-035036{color:#F1FA8C;}.ct-166232{color:#FF79C6;}.ct-432594{color:#8BE9FD;font-style:italic;}.ct-784317{color:#6272A4;}.ct-882767{color:#E9F284;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"create-a-middleware","depth":2,"text":"Create a middleware"}]}},"_type":"markdown","_id":"content:blog:8-use-laravel-route-model-binding-into-middlewares.md","_source":"content","_file":"blog/8-use-laravel-route-model-binding-into-middlewares.md","_extension":"md"}