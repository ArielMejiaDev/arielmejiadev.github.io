{"_path":"/blog/31-fix-nuxtjs-laravel-cors-issue","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Fix NuxtJS Laravel CORS Issue","description":"Resolve local CORS issues during development between a localhost API and NuxtJS app","id":31,"published":true,"date":"September 10th, 2023","cover_image":null,"tags":["Laravel","Vue"],"announcement_banner":null,"announcement_link":null,"readingTime":{"text":"2 min read","minutes":1.18,"time":70800,"words":236},"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"access-apps-from-the-browser"},"children":[{"type":"text","value":"Access apps from the browser"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For a local environment on the backend side using "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Herd/Valet"}]},{"type":"text","value":" "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Laravel"}]},{"type":"text","value":" provides two ways to visit your application in the browser"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Running "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"php artisan serve"}]},{"type":"text","value":": "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"http://127.0.0.1:80"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Using "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Vite"}]},{"type":"text","value":" "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"npm run dev"}]},{"type":"text","value":" to: "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"http://backend-app.test"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Both ways are valid, on the frontend side "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"NuxtJS"}]},{"type":"text","value":" provides an easy way to access your project"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"npm run dev"}]},{"type":"text","value":": "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"http://127.0.0.1:8000"}]}]},{"type":"element","tag":"h2","props":{"id":"set-both-projects"},"children":[{"type":"text","value":"Set both projects"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In order to test that both technologies work together\njust add a backend "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"route"}]},{"type":"text","value":" in "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Laravel"}]},{"type":"text","value":" app and check the response in "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"NuxtJS"}]}]},{"type":"element","tag":"pre","props":{"className":"language-php dracula","code":"// api.php file\n\nRoute::get('hello-world', fn () => 'Hello World');\n","language":"php","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"// api.php file\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-432594"},"children":[{"type":"text","value":"Route"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"get"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"hello-world"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"fn"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" () => "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"Hello World"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":");"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"NuxtJS"}]},{"type":"text","value":" we can make a request and get the response in any component"}]},{"type":"element","tag":"pre","props":{"className":"language-html dracula","code":"<script setup>\n// replace the endpoint with your laravel api url\n    \nconst { data, pending, error } = await useFetch('http://backend-app.test/hello-world');\n</script>\n\n<template>\n<h1>{{ data }}</h1>\n</template>\n","language":"html","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-711501"},"children":[{"type":"text","value":"setup"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"// replace the endpoint with your laravel api url\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" { data, pending, error } "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"useFetch"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"http://backend-app.test/hello-world"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"h1"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":">{{ data }}</"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"h1"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":">"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you open the console you are going to be able to see an issue related to "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"CORS"}]}]},{"type":"element","tag":"h2","props":{"id":"solving-cors-problem"},"children":[{"type":"text","value":"Solving CORS problem"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Go to "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":" file in the root directory and add a "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"routeRule"}]},{"type":"text","value":" object"}]},{"type":"element","tag":"pre","props":{"className":"language-typescript dracula","code":"export default defineNuxtConfig({\n  devtools: { enabled: true },\n  // ...\n  routeRules: {\n    '/api/**': { proxy: { to: \"http://backend-app.test/**\" } }\n  }\n})\n","language":"typescript","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":"default"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"defineNuxtConfig"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"  devtools"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" { enabled"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531774"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"// ...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"  routeRules"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"/api/**"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" { proxy"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" { to"}]},{"type":"element","tag":"span","props":{"class":"ct-166232"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"http://backend-app.test/**"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" } }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"})"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now just rebuild the frontend by re-running: "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"npm run dev"}]},{"type":"text","value":" and it now should show the request response without issues"}]},{"type":"element","tag":"h2","props":{"id":"take-in-mind"},"children":[{"type":"text","value":"Take in mind:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You do not need to do this for external API services"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You can add a prefix to your backend route like: "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"http://backend-app.test/api/**"}]},{"type":"text","value":" to allow wildcard only for api routes"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If you are using a "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"JsonResource"}]},{"type":"text","value":" wrapper as a response in "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Laravel"}]},{"type":"text","value":" usually the response would be available when fetching the data as: "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"data.data"}]},{"type":"text","value":" in the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Nuxt"}]},{"type":"text","value":" side"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Thanks for reading!"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":".dracula{color:#F8F8F2;background:#282A36;}.ct-784317{color:#6272A4;}.ct-432594{color:#8BE9FD;font-style:italic;}.ct-166232{color:#FF79C6;}.ct-711500{color:#50FA7B;}.ct-183901{color:#F8F8F2;}.ct-882767{color:#E9F284;}.ct-035036{color:#F1FA8C;}.ct-711501{color:#50FA7B;font-style:italic;}.ct-531774{color:#BD93F9;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"access-apps-from-the-browser","depth":2,"text":"Access apps from the browser"},{"id":"set-both-projects","depth":2,"text":"Set both projects"},{"id":"solving-cors-problem","depth":2,"text":"Solving CORS problem"},{"id":"take-in-mind","depth":2,"text":"Take in mind:"}]}},"_type":"markdown","_id":"content:blog:31-fix-nuxtjs-laravel-cors-issue.md","_source":"content","_file":"blog/31-fix-nuxtjs-laravel-cors-issue.md","_extension":"md"}