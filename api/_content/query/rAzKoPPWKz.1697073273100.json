{"_path":"/blog/29-run-duster-in-laravel","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Lint and Fix your Laravel Code with Duster and Husky","description":"Lint and Fix your Laravel Code with Duster and Husky","id":29,"published":true,"date":"July 19th, 2023","tags":["Laravel"],"cover_image":null,"announcement_banner":null,"announcement_link":null,"readingTime":{"text":"1 min read","minutes":0.92,"time":55200,"words":184},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Tighten"}]},{"type":"text","value":" mentions on its blog"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Duster is an opinionated linter and fixer for Laravel code, that takes the best of Laravelâ€™s Pint,\ntogether with the power of PHP_CodeSniffer and PHP-CS-Fixer"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Duster works on the command line, with "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Husky"}]},{"type":"text","value":" or use it's premade "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"GitHub Action"}]},{"type":"text","value":" to run it in your "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"CI pipeline"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"During installation & setup process I found a little issue related to "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Husky"}]},{"type":"text","value":" so here I share the solutions"}]},{"type":"element","tag":"h2","props":{"id":"install-duster"},"children":[{"type":"text","value":"Install Duster"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"composer require tightenco/duster --dev\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"composer"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"require"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"tightenco/duster"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531774"},"children":[{"type":"text","value":"--dev"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"check-that-your-project-has-git-initialized"},"children":[{"type":"text","value":"Check that your project has git initialized"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If not you can initialize it with"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"git init\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"git"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"init"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"install-husky"},"children":[{"type":"text","value":"Install Husky"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"npm i -D husky\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"i"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531774"},"children":[{"type":"text","value":"-D"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"husky"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"install-lint-staged"},"children":[{"type":"text","value":"Install Lint-Staged"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"npm i -D lint-staged\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"i"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531774"},"children":[{"type":"text","value":"-D"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"lint-staged"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"initialize-husky"},"children":[{"type":"text","value":"Initialize Husky"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"npx husky-init\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"npx"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"husky-init"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"add-husky-pre-commit-file"},"children":[{"type":"text","value":"Add Husky Pre-commit file"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"npx husky add ./.husky/pre-commit 'npx --no-install lint-staged'\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"npx"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"husky"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"add"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"./.husky/pre-commit"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"npx --no-install lint-staged"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"'"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"remove-npm-test-command-from-pre-commit-file"},"children":[{"type":"text","value":"Remove "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"npm test"}]},{"type":"text","value":" command from "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"pre-commit"}]},{"type":"text","value":" file"}]},{"type":"element","tag":"pre","props":{"className":"language-bash dracula","code":"#!/usr/bin/env sh\n. \"$(dirname -- \"$0\")/_/husky.sh\"\nnpx --no-install lint-staged\n\nnpm run test # this line should be removed\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"#!/usr/bin/env sh\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-432593"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"$("}]},{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"dirname"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531774"},"children":[{"type":"text","value":"--"}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-283083"},"children":[{"type":"text","value":"$0"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":")/_/husky.sh"}]},{"type":"element","tag":"span","props":{"class":"ct-882767"},"children":[{"type":"text","value":"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"npx"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-531774"},"children":[{"type":"text","value":"--no-install"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"lint-staged\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"run"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"test"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-784317"},"children":[{"type":"text","value":"# this line should be removed"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"configure-lint-staged-for-php-files-in-packagejson-file"},"children":[{"type":"text","value":"Configure Lint Staged for "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"php"}]},{"type":"text","value":" files in "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" file"}]},{"type":"element","tag":"pre","props":{"className":"language-html dracula","code":"    ...\n    \"lint-staged\": {\n        \"**/*.php*\": [\n            \"vendor/bin/duster lint\"\n        ]\n    }\n    ...\n","language":"html","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    ...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    \"lint-staged\": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"        \"**/*.php*\": [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"            \"vendor/bin/duster lint\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"        ]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":"    ..."}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Instead of just "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"lint"}]},{"type":"text","value":" your codebase, you can use the Duster "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"fix"}]},{"type":"text","value":" command in order to fix the code base automatically."}]},{"type":"element","tag":"h2","props":{"id":"set-github-actions"},"children":[{"type":"text","value":"Set Github Actions"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Just execute"}]},{"type":"element","tag":"pre","props":{"className":"language-shell dracula","code":"./vendor/bin/duster github-actions\n","language":"shell","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"class":"ct-711500"},"children":[{"type":"text","value":"./vendor/bin/duster"}]},{"type":"element","tag":"span","props":{"class":"ct-183901"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-035036"},"children":[{"type":"text","value":"github-actions"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It will publish a github action workflow for Duster, you can configure it and read more about Duster in "},{"type":"element","tag":"a","props":{"href":"https://github.com/tighten/duster#duster","rel":["nofollow"]},"children":[{"type":"text","value":"the docs"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Thanks for reading!"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":".dracula{color:#F8F8F2;background:#282A36;}.ct-711500{color:#50FA7B;}.ct-183901{color:#F8F8F2;}.ct-035036{color:#F1FA8C;}.ct-531774{color:#BD93F9;}.ct-882767{color:#E9F284;}.ct-784317{color:#6272A4;}.ct-432593{color:#8BE9FD;}.ct-283083{color:#FFB86C;font-style:italic;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"install-duster","depth":2,"text":"Install Duster"},{"id":"check-that-your-project-has-git-initialized","depth":2,"text":"Check that your project has git initialized"},{"id":"install-husky","depth":2,"text":"Install Husky"},{"id":"install-lint-staged","depth":2,"text":"Install Lint-Staged"},{"id":"initialize-husky","depth":2,"text":"Initialize Husky"},{"id":"add-husky-pre-commit-file","depth":2,"text":"Add Husky Pre-commit file"},{"id":"remove-npm-test-command-from-pre-commit-file","depth":2,"text":"Remove npm test command from pre-commit file"},{"id":"configure-lint-staged-for-php-files-in-packagejson-file","depth":2,"text":"Configure Lint Staged for php files in package.json file"},{"id":"set-github-actions","depth":2,"text":"Set Github Actions"}]}},"_type":"markdown","_id":"content:blog:29-run-duster-in-laravel.md","_source":"content","_file":"blog/29-run-duster-in-laravel.md","_extension":"md"}