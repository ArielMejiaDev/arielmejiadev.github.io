[{"data":1,"prerenderedAt":905},["Reactive",2],{"post-2-set-dynamic-subdomains-with-laravel-forge":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"id":10,"published":11,"date":12,"cover_image":13,"tags":14,"announcement_banner":17,"announcement_link":17,"readingTime":18,"body":23,"_type":900,"_id":901,"_source":902,"_file":903,"_extension":904},"/blog/2-set-dynamic-subdomains-with-laravel-forge","blog",false,"","Set dynamic subdomains in Laravel Forge.","Set dynamic subdomains for multiple users, organizations or any other model in production with Laravel forge",2,true,"June 3rd, 2020","https://dev-to-uploads.s3.amazonaws.com/i/lsqvvvptoj6y0tba76fq.png",[15,16],"Laravel","DevOps",null,{"text":19,"minutes":20,"time":21,"words":22},"2 min read",1.605,96300,321,{"type":24,"children":25,"toc":890},"root",[26,35,49,282,311,324,340,424,442,459,465,476,556,566,577,582,601,607,618,627,633,645,653,677,685,691,709,717,734,740,745,802,807,815,821,840,848,854,866,874,879,884],{"type":27,"tag":28,"props":29,"children":31},"element","h2",{"id":30},"in-development",[32],{"type":33,"value":34},"text","In Development",{"type":27,"tag":36,"props":37,"children":38},"p",{},[39,41,47],{"type":33,"value":40},"In ",{"type":27,"tag":42,"props":43,"children":44},"code",{},[45],{"type":33,"value":46},"routes/web.php",{"type":33,"value":48}," paste the route group:",{"type":27,"tag":50,"props":51,"children":55},"pre",{"className":52,"code":53,"language":54,"meta":7},"language-php dracula","Route::domain('{user:slug}.' . config('app.base_url'))->group(function () {\n\n    Route::get('/', UserController::class)->name('user.homepage');\n\n});\n","php",[56],{"type":27,"tag":42,"props":57,"children":58},{"__ignoreMap":7},[59,170,176,266,273],{"type":27,"tag":60,"props":61,"children":64},"span",{"class":62,"line":63},"line",1,[65,71,77,83,89,95,101,105,110,115,119,124,128,132,137,141,146,151,156,160,165],{"type":27,"tag":60,"props":66,"children":68},{"class":67},"ct-432594",[69],{"type":33,"value":70},"Route",{"type":27,"tag":60,"props":72,"children":74},{"class":73},"ct-166232",[75],{"type":33,"value":76},"::",{"type":27,"tag":60,"props":78,"children":80},{"class":79},"ct-711500",[81],{"type":33,"value":82},"domain",{"type":27,"tag":60,"props":84,"children":86},{"class":85},"ct-183901",[87],{"type":33,"value":88},"(",{"type":27,"tag":60,"props":90,"children":92},{"class":91},"ct-882767",[93],{"type":33,"value":94},"'",{"type":27,"tag":60,"props":96,"children":98},{"class":97},"ct-035036",[99],{"type":33,"value":100},"{user:slug}.",{"type":27,"tag":60,"props":102,"children":103},{"class":91},[104],{"type":33,"value":94},{"type":27,"tag":60,"props":106,"children":107},{"class":85},[108],{"type":33,"value":109}," ",{"type":27,"tag":60,"props":111,"children":112},{"class":73},[113],{"type":33,"value":114},".",{"type":27,"tag":60,"props":116,"children":117},{"class":85},[118],{"type":33,"value":109},{"type":27,"tag":60,"props":120,"children":121},{"class":79},[122],{"type":33,"value":123},"config",{"type":27,"tag":60,"props":125,"children":126},{"class":85},[127],{"type":33,"value":88},{"type":27,"tag":60,"props":129,"children":130},{"class":91},[131],{"type":33,"value":94},{"type":27,"tag":60,"props":133,"children":134},{"class":97},[135],{"type":33,"value":136},"app.base_url",{"type":27,"tag":60,"props":138,"children":139},{"class":91},[140],{"type":33,"value":94},{"type":27,"tag":60,"props":142,"children":143},{"class":85},[144],{"type":33,"value":145},"))",{"type":27,"tag":60,"props":147,"children":148},{"class":73},[149],{"type":33,"value":150},"->",{"type":27,"tag":60,"props":152,"children":153},{"class":79},[154],{"type":33,"value":155},"group",{"type":27,"tag":60,"props":157,"children":158},{"class":85},[159],{"type":33,"value":88},{"type":27,"tag":60,"props":161,"children":162},{"class":73},[163],{"type":33,"value":164},"function",{"type":27,"tag":60,"props":166,"children":167},{"class":85},[168],{"type":33,"value":169}," () {\n",{"type":27,"tag":60,"props":171,"children":172},{"class":62,"line":10},[173],{"type":27,"tag":60,"props":174,"children":175},{},[],{"type":27,"tag":60,"props":177,"children":179},{"class":62,"line":178},3,[180,185,189,193,198,202,206,211,215,220,225,230,235,239,244,248,252,257,261],{"type":27,"tag":60,"props":181,"children":182},{"class":85},[183],{"type":33,"value":184},"    ",{"type":27,"tag":60,"props":186,"children":187},{"class":67},[188],{"type":33,"value":70},{"type":27,"tag":60,"props":190,"children":191},{"class":73},[192],{"type":33,"value":76},{"type":27,"tag":60,"props":194,"children":195},{"class":79},[196],{"type":33,"value":197},"get",{"type":27,"tag":60,"props":199,"children":200},{"class":85},[201],{"type":33,"value":88},{"type":27,"tag":60,"props":203,"children":204},{"class":91},[205],{"type":33,"value":94},{"type":27,"tag":60,"props":207,"children":208},{"class":97},[209],{"type":33,"value":210},"/",{"type":27,"tag":60,"props":212,"children":213},{"class":91},[214],{"type":33,"value":94},{"type":27,"tag":60,"props":216,"children":217},{"class":85},[218],{"type":33,"value":219},", ",{"type":27,"tag":60,"props":221,"children":222},{"class":67},[223],{"type":33,"value":224},"UserController",{"type":27,"tag":60,"props":226,"children":227},{"class":73},[228],{"type":33,"value":229},"::class",{"type":27,"tag":60,"props":231,"children":232},{"class":85},[233],{"type":33,"value":234},")",{"type":27,"tag":60,"props":236,"children":237},{"class":73},[238],{"type":33,"value":150},{"type":27,"tag":60,"props":240,"children":241},{"class":79},[242],{"type":33,"value":243},"name",{"type":27,"tag":60,"props":245,"children":246},{"class":85},[247],{"type":33,"value":88},{"type":27,"tag":60,"props":249,"children":250},{"class":91},[251],{"type":33,"value":94},{"type":27,"tag":60,"props":253,"children":254},{"class":97},[255],{"type":33,"value":256},"user.homepage",{"type":27,"tag":60,"props":258,"children":259},{"class":91},[260],{"type":33,"value":94},{"type":27,"tag":60,"props":262,"children":263},{"class":85},[264],{"type":33,"value":265},");\n",{"type":27,"tag":60,"props":267,"children":269},{"class":62,"line":268},4,[270],{"type":27,"tag":60,"props":271,"children":272},{},[],{"type":27,"tag":60,"props":274,"children":276},{"class":62,"line":275},5,[277],{"type":27,"tag":60,"props":278,"children":279},{"class":85},[280],{"type":33,"value":281},"});",{"type":27,"tag":36,"props":283,"children":284},{},[285,290,292,297,299,304,306],{"type":27,"tag":42,"props":286,"children":287},{},[288],{"type":33,"value":289},"base_url",{"type":33,"value":291}," is added by the ",{"type":27,"tag":42,"props":293,"children":294},{},[295],{"type":33,"value":296},"config()",{"type":33,"value":298}," helper, do not use the ",{"type":27,"tag":42,"props":300,"children":301},{},[302],{"type":33,"value":303},"env()",{"type":33,"value":305}," method here,\nthis could cause errors if you fired the command ",{"type":27,"tag":42,"props":307,"children":308},{},[309],{"type":33,"value":310},"php artisan cache:clear",{"type":27,"tag":36,"props":312,"children":313},{},[314,316,322],{"type":33,"value":315},"In this example you would need to add the column ",{"type":27,"tag":317,"props":318,"children":319},"strong",{},[320],{"type":33,"value":321},"slug",{"type":33,"value":323}," in your user migration.",{"type":27,"tag":36,"props":325,"children":326},{},[327,329,333,335],{"type":33,"value":328},"The part of the route that adds the ",{"type":27,"tag":42,"props":330,"children":331},{},[332],{"type":33,"value":289},{"type":33,"value":334}," should be added in ",{"type":27,"tag":42,"props":336,"children":337},{},[338],{"type":33,"value":339},"config/app.php",{"type":27,"tag":50,"props":341,"children":343},{"className":52,"code":342,"language":54,"meta":7},"'base_url' => env('BASE_URL', 'localhost'),\n",[344],{"type":27,"tag":42,"props":345,"children":346},{"__ignoreMap":7},[347],{"type":27,"tag":60,"props":348,"children":349},{"class":62,"line":63},[350,354,358,362,366,371,375,380,384,388,393,397,402,406,410,415,419],{"type":27,"tag":60,"props":351,"children":352},{"class":91},[353],{"type":33,"value":94},{"type":27,"tag":60,"props":355,"children":356},{"class":97},[357],{"type":33,"value":289},{"type":27,"tag":60,"props":359,"children":360},{"class":91},[361],{"type":33,"value":94},{"type":27,"tag":60,"props":363,"children":364},{"class":85},[365],{"type":33,"value":109},{"type":27,"tag":60,"props":367,"children":368},{"class":73},[369],{"type":33,"value":370},"=>",{"type":27,"tag":60,"props":372,"children":373},{"class":85},[374],{"type":33,"value":109},{"type":27,"tag":60,"props":376,"children":377},{"class":79},[378],{"type":33,"value":379},"env",{"type":27,"tag":60,"props":381,"children":382},{"class":85},[383],{"type":33,"value":88},{"type":27,"tag":60,"props":385,"children":386},{"class":91},[387],{"type":33,"value":94},{"type":27,"tag":60,"props":389,"children":390},{"class":97},[391],{"type":33,"value":392},"BASE_URL",{"type":27,"tag":60,"props":394,"children":395},{"class":91},[396],{"type":33,"value":94},{"type":27,"tag":60,"props":398,"children":399},{"class":85},[400],{"type":33,"value":401},",",{"type":27,"tag":60,"props":403,"children":404},{"class":79},[405],{"type":33,"value":109},{"type":27,"tag":60,"props":407,"children":408},{"class":91},[409],{"type":33,"value":94},{"type":27,"tag":60,"props":411,"children":412},{"class":97},[413],{"type":33,"value":414},"localhost",{"type":27,"tag":60,"props":416,"children":417},{"class":91},[418],{"type":33,"value":94},{"type":27,"tag":60,"props":420,"children":421},{"class":85},[422],{"type":33,"value":423},"),",{"type":27,"tag":36,"props":425,"children":426},{},[427,429,433,435,440],{"type":33,"value":428},"Set a ",{"type":27,"tag":42,"props":430,"children":431},{},[432],{"type":33,"value":289},{"type":33,"value":434}," in the application ",{"type":27,"tag":42,"props":436,"children":437},{},[438],{"type":33,"value":439},".env",{"type":33,"value":441}," file:",{"type":27,"tag":50,"props":443,"children":447},{"className":444,"code":445,"language":446,"meta":7},"language-dotenv dracula","BASE_URL=myapp.test\n","dotenv",[448],{"type":27,"tag":42,"props":449,"children":450},{"__ignoreMap":7},[451],{"type":27,"tag":60,"props":452,"children":453},{"class":62,"line":63},[454],{"type":27,"tag":60,"props":455,"children":456},{},[457],{"type":33,"value":458},"BASE_URL=myapp.test",{"type":27,"tag":28,"props":460,"children":462},{"id":461},"create-a-controller",[463],{"type":33,"value":464},"Create a controller",{"type":27,"tag":36,"props":466,"children":467},{},[468,469,474],{"type":33,"value":40},{"type":27,"tag":42,"props":470,"children":471},{},[472],{"type":33,"value":473},"app/Http/Controllers/Users/UserController",{"type":33,"value":475},":",{"type":27,"tag":50,"props":477,"children":479},{"className":52,"code":478,"language":54,"meta":7},"public function __invoke(User $user)\n{\n    return $user;\n}\n",[480],{"type":27,"tag":42,"props":481,"children":482},{"__ignoreMap":7},[483,523,531,548],{"type":27,"tag":60,"props":484,"children":485},{"class":62,"line":63},[486,491,495,499,503,509,513,518],{"type":27,"tag":60,"props":487,"children":488},{"class":73},[489],{"type":33,"value":490},"public",{"type":27,"tag":60,"props":492,"children":493},{"class":85},[494],{"type":33,"value":109},{"type":27,"tag":60,"props":496,"children":497},{"class":73},[498],{"type":33,"value":164},{"type":27,"tag":60,"props":500,"children":501},{"class":85},[502],{"type":33,"value":109},{"type":27,"tag":60,"props":504,"children":506},{"class":505},"ct-531774",[507],{"type":33,"value":508},"__invoke",{"type":27,"tag":60,"props":510,"children":511},{"class":85},[512],{"type":33,"value":88},{"type":27,"tag":60,"props":514,"children":515},{"class":67},[516],{"type":33,"value":517},"User",{"type":27,"tag":60,"props":519,"children":520},{"class":85},[521],{"type":33,"value":522}," $user)\n",{"type":27,"tag":60,"props":524,"children":525},{"class":62,"line":10},[526],{"type":27,"tag":60,"props":527,"children":528},{"class":85},[529],{"type":33,"value":530},"{\n",{"type":27,"tag":60,"props":532,"children":533},{"class":62,"line":178},[534,538,543],{"type":27,"tag":60,"props":535,"children":536},{"class":85},[537],{"type":33,"value":184},{"type":27,"tag":60,"props":539,"children":540},{"class":73},[541],{"type":33,"value":542},"return",{"type":27,"tag":60,"props":544,"children":545},{"class":85},[546],{"type":33,"value":547}," $user;\n",{"type":27,"tag":60,"props":549,"children":550},{"class":62,"line":268},[551],{"type":27,"tag":60,"props":552,"children":553},{"class":85},[554],{"type":33,"value":555},"}",{"type":27,"tag":36,"props":557,"children":558},{},[559,561],{"type":33,"value":560},"Now it can be tested in the browser with something like: ",{"type":27,"tag":42,"props":562,"children":563},{},[564],{"type":33,"value":565},"/john-doe/myapp.test",{"type":27,"tag":36,"props":567,"children":568},{},[569,571,575],{"type":33,"value":570},"It returns the corresponding user for that slug, if you do not have any user with the ",{"type":27,"tag":317,"props":572,"children":573},{},[574],{"type":33,"value":321},{"type":33,"value":576}," it will throw a 404 error.",{"type":27,"tag":36,"props":578,"children":579},{},[580],{"type":33,"value":581},"You can add users with tinker and test it.",{"type":27,"tag":36,"props":583,"children":584},{},[585,587,592,594,599],{"type":33,"value":586},"If all works it is time to make a deployment on ",{"type":27,"tag":317,"props":588,"children":589},{},[590],{"type":33,"value":591},"forge",{"type":33,"value":593},", in this example I will use ",{"type":27,"tag":317,"props":595,"children":596},{},[597],{"type":33,"value":598},"digital ocean",{"type":33,"value":600}," as the server provider.",{"type":27,"tag":28,"props":602,"children":604},{"id":603},"_1-create-your-project-on-forge",[605],{"type":33,"value":606},"1 Create your project on forge:",{"type":27,"tag":36,"props":608,"children":609},{},[610,612,617],{"type":33,"value":611},"Just write your domain and be sure to check ",{"type":27,"tag":317,"props":613,"children":614},{},[615],{"type":33,"value":616},"allow wildcards",{"type":33,"value":114},{"type":27,"tag":36,"props":619,"children":620},{},[621],{"type":27,"tag":622,"props":623,"children":626},"img",{"alt":624,"src":625},"Create Server in Forge Screen","/images/blog/2/forge-screen.png",[],{"type":27,"tag":28,"props":628,"children":630},{"id":629},"_2-add-your-repo",[631],{"type":33,"value":632},"2 Add your repo:",{"type":27,"tag":36,"props":634,"children":635},{},[636,638,643],{"type":33,"value":637},"The full repo name comes from the ",{"type":27,"tag":42,"props":639,"children":640},{},[641],{"type":33,"value":642},"github",{"type":33,"value":644}," repo url (highlighted):",{"type":27,"tag":36,"props":646,"children":647},{},[648],{"type":27,"tag":622,"props":649,"children":652},{"alt":650,"src":651},"Create Repository home in github","/images/blog/2/github-screen.png",[],{"type":27,"tag":36,"props":654,"children":655},{},[656,658,663,665,670,672,676],{"type":33,"value":657},"This convention from ",{"type":27,"tag":42,"props":659,"children":660},{},[661],{"type":33,"value":662},"githubusername/repo",{"type":33,"value":664}," goes in the ",{"type":27,"tag":42,"props":666,"children":667},{},[668],{"type":33,"value":669},"repository",{"type":33,"value":671}," field in ",{"type":27,"tag":317,"props":673,"children":674},{},[675],{"type":33,"value":591},{"type":33,"value":475},{"type":27,"tag":36,"props":678,"children":679},{},[680],{"type":27,"tag":622,"props":681,"children":684},{"alt":682,"src":683},"Set Github in Forge Screen","/images/blog/2/forge-screen-2.png",[],{"type":27,"tag":28,"props":686,"children":688},{"id":687},"_3-set-your-environment",[689],{"type":33,"value":690},"3 Set your environment:",{"type":27,"tag":36,"props":692,"children":693},{},[694,696,701,703,707],{"type":33,"value":695},"It needs to add the proper ",{"type":27,"tag":42,"props":697,"children":698},{},[699],{"type":33,"value":700},"APP_URL",{"type":33,"value":702}," value in the ",{"type":27,"tag":42,"props":704,"children":705},{},[706],{"type":33,"value":439},{"type":33,"value":708}," file on forge:",{"type":27,"tag":36,"props":710,"children":711},{},[712],{"type":27,"tag":622,"props":713,"children":716},{"alt":714,"src":715},"Edit Env File in Forge Screen","/images/blog/2/forge-screen-3.png",[],{"type":27,"tag":36,"props":718,"children":719},{},[720,722,726,728,732],{"type":33,"value":721},"Here I add the ",{"type":27,"tag":42,"props":723,"children":724},{},[725],{"type":33,"value":392},{"type":33,"value":727}," and make the ",{"type":27,"tag":42,"props":729,"children":730},{},[731],{"type":33,"value":700},{"type":33,"value":733}," dynamically, but both can also be written.",{"type":27,"tag":28,"props":735,"children":737},{"id":736},"_4-set-the-domain-in-digital-ocean",[738],{"type":33,"value":739},"4 Set the domain in Digital Ocean:",{"type":27,"tag":36,"props":741,"children":742},{},[743],{"type":33,"value":744},"You need to add some records:",{"type":27,"tag":746,"props":747,"children":748},"ul",{},[749,767,784],{"type":27,"tag":750,"props":751,"children":752},"li",{},[753,755,760,762],{"type":33,"value":754},"by default an ",{"type":27,"tag":42,"props":756,"children":757},{},[758],{"type":33,"value":759},"A",{"type":33,"value":761}," record for the base url ",{"type":27,"tag":42,"props":763,"children":764},{},[765],{"type":33,"value":766},"@",{"type":27,"tag":750,"props":768,"children":769},{},[770,772,777,779],{"type":33,"value":771},"a ",{"type":27,"tag":42,"props":773,"children":774},{},[775],{"type":33,"value":776},"CNAME",{"type":33,"value":778}," record for ",{"type":27,"tag":42,"props":780,"children":781},{},[782],{"type":33,"value":783},"www",{"type":27,"tag":750,"props":785,"children":786},{},[787,789,793,795,800],{"type":33,"value":788},"and a multi-domain ",{"type":27,"tag":42,"props":790,"children":791},{},[792],{"type":33,"value":759},{"type":33,"value":794}," record with ",{"type":27,"tag":42,"props":796,"children":797},{},[798],{"type":33,"value":799},"*.",{"type":33,"value":801}," as a prefix",{"type":27,"tag":36,"props":803,"children":804},{},[805],{"type":33,"value":806},"This is how your config should look like:",{"type":27,"tag":36,"props":808,"children":809},{},[810],{"type":27,"tag":622,"props":811,"children":814},{"alt":812,"src":813},"A Records in Digital Ocean Dashboard","/images/blog/2/digital-ocean-screen.png",[],{"type":27,"tag":28,"props":816,"children":818},{"id":817},"_5-create-an-api-token",[819],{"type":33,"value":820},"5 Create an API TOKEN",{"type":27,"tag":36,"props":822,"children":823},{},[824,826,831,833,838],{"type":33,"value":825},"On the sidebar, go to ",{"type":27,"tag":317,"props":827,"children":828},{},[829],{"type":33,"value":830},"API",{"type":33,"value":832}," section and generate a ",{"type":27,"tag":317,"props":834,"children":835},{},[836],{"type":33,"value":837},"new token",{"type":33,"value":839},", copy the token and save it for later",{"type":27,"tag":36,"props":841,"children":842},{},[843],{"type":27,"tag":622,"props":844,"children":847},{"alt":845,"src":846},"Create Personal Access Tokens Digital Ocean Dashboard","/images/blog/2/digital-ocean-screen-2.png",[],{"type":27,"tag":28,"props":849,"children":851},{"id":850},"_6-configure-the-ssl-certificate",[852],{"type":33,"value":853},"6 Configure the SSL certificate:",{"type":27,"tag":36,"props":855,"children":856},{},[857,859,864],{"type":33,"value":858},"This step is particularly complicated because sometimes it takes a couple of hours to properly propagate the changes\nfrom ",{"type":27,"tag":317,"props":860,"children":861},{},[862],{"type":33,"value":863},"Digital Ocean",{"type":33,"value":865},", this applies to any other provider.",{"type":27,"tag":36,"props":867,"children":868},{},[869],{"type":27,"tag":622,"props":870,"children":873},{"alt":871,"src":872},"Add SSL Certificate in Forge","/images/blog/2/forge-screen-4.png",[],{"type":27,"tag":36,"props":875,"children":876},{},[877],{"type":33,"value":878},"Sometimes it works immediately, and sometimes takes a while and needs more time to get propagation,\nbetween 2 or 6 hours, but it can take more.",{"type":27,"tag":36,"props":880,"children":881},{},[882],{"type":33,"value":883},"Thanks for reading!",{"type":27,"tag":885,"props":886,"children":887},"style",{},[888],{"type":33,"value":889},".dracula{color:#F8F8F2;background:#282A36;}.ct-432594{color:#8BE9FD;font-style:italic;}.ct-166232{color:#FF79C6;}.ct-711500{color:#50FA7B;}.ct-183901{color:#F8F8F2;}.ct-882767{color:#E9F284;}.ct-035036{color:#F1FA8C;}.ct-531774{color:#BD93F9;}",{"title":7,"searchDepth":10,"depth":10,"links":891},[892,893,894,895,896,897,898,899],{"id":30,"depth":10,"text":34},{"id":461,"depth":10,"text":464},{"id":603,"depth":10,"text":606},{"id":629,"depth":10,"text":632},{"id":687,"depth":10,"text":690},{"id":736,"depth":10,"text":739},{"id":817,"depth":10,"text":820},{"id":850,"depth":10,"text":853},"markdown","content:blog:2-set-dynamic-subdomains-with-laravel-forge.md","content","blog/2-set-dynamic-subdomains-with-laravel-forge.md","md",1696974820724]