[{"data":1,"prerenderedAt":666},["Reactive",2],{"post-11-test-redirect-after-login-by-roles-in-laravel":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"id":10,"published":11,"date":12,"cover_image":13,"tags":14,"announcement_banner":16,"announcement_link":16,"readingTime":17,"body":22,"_type":661,"_id":662,"_source":663,"_file":664,"_extension":665},"/blog/11-test-redirect-after-login-by-roles-in-laravel","blog",false,"","Test redirects after login by roles with Laravel","Make assertions to test redirects by role after login",11,true,"September 15th, 2020","https://dev-to-uploads.s3.amazonaws.com/i/o4cg7w9ekjqkb99xcp51.png",[15],"Laravel",null,{"text":18,"minutes":19,"time":20,"words":21},"1 min read",0.575,34500,115,{"type":23,"children":24,"toc":659},"root",[25,37,55,74,569,577,648,653],{"type":26,"tag":27,"props":28,"children":29},"element","p",{},[30],{"type":26,"tag":31,"props":32,"children":33},"strong",{},[34],{"type":35,"value":36},"text","Common scenario",{"type":26,"tag":27,"props":38,"children":39},{},[40,42,48,50],{"type":35,"value":41},"Users with different ",{"type":26,"tag":43,"props":44,"children":45},"code",{},[46],{"type":35,"value":47},"roles",{"type":35,"value":49}," should be redirected to different dashboards after ",{"type":26,"tag":43,"props":51,"children":52},{},[53],{"type":35,"value":54},"login",{"type":26,"tag":27,"props":56,"children":57},{},[58,60,65,67,72],{"type":35,"value":59},"For the sake of simplicity the example is using ",{"type":26,"tag":43,"props":61,"children":62},{},[63],{"type":35,"value":64},"user",{"type":35,"value":66}," model property ",{"type":26,"tag":43,"props":68,"children":69},{},[70],{"type":35,"value":71},"role",{"type":35,"value":73}," as simple string column,\nbut you can add as many complexity as you need",{"type":26,"tag":75,"props":76,"children":80},"pre",{"className":77,"code":78,"language":79,"meta":7},"language-php dracula","use RefreshDatabase;\n/** @test */\npublic function test_app_admin_can_login_and_go_to_admin_dashboard()\n{\n    $user = User::factory()->create([\n        'role' => 'admin'\n    ]);\n    \n    session()->setPreviousUrl('/login');\n    \n    $response = $this->post('/login', [\n        'email' => $user->email,\n        'password' => 'password',\n    ]);\n    \n    $response->assertLocation(route('admin.dashboard')); // admin/dashboard\n}\n","php",[81],{"type":26,"tag":43,"props":82,"children":83},{"__ignoreMap":7},[84,113,123,156,165,218,269,278,287,337,345,397,440,490,498,506,560],{"type":26,"tag":85,"props":86,"children":89},"span",{"class":87,"line":88},"line",1,[90,96,102,108],{"type":26,"tag":85,"props":91,"children":93},{"class":92},"ct-166232",[94],{"type":35,"value":95},"use",{"type":26,"tag":85,"props":97,"children":99},{"class":98},"ct-183901",[100],{"type":35,"value":101}," ",{"type":26,"tag":85,"props":103,"children":105},{"class":104},"ct-432594",[106],{"type":35,"value":107},"RefreshDatabase",{"type":26,"tag":85,"props":109,"children":110},{"class":98},[111],{"type":35,"value":112},";\n",{"type":26,"tag":85,"props":114,"children":116},{"class":87,"line":115},2,[117],{"type":26,"tag":85,"props":118,"children":120},{"class":119},"ct-784317",[121],{"type":35,"value":122},"/** @test */\n",{"type":26,"tag":85,"props":124,"children":126},{"class":87,"line":125},3,[127,132,136,141,145,151],{"type":26,"tag":85,"props":128,"children":129},{"class":92},[130],{"type":35,"value":131},"public",{"type":26,"tag":85,"props":133,"children":134},{"class":98},[135],{"type":35,"value":101},{"type":26,"tag":85,"props":137,"children":138},{"class":92},[139],{"type":35,"value":140},"function",{"type":26,"tag":85,"props":142,"children":143},{"class":98},[144],{"type":35,"value":101},{"type":26,"tag":85,"props":146,"children":148},{"class":147},"ct-711500",[149],{"type":35,"value":150},"test_app_admin_can_login_and_go_to_admin_dashboard",{"type":26,"tag":85,"props":152,"children":153},{"class":98},[154],{"type":35,"value":155},"()\n",{"type":26,"tag":85,"props":157,"children":159},{"class":87,"line":158},4,[160],{"type":26,"tag":85,"props":161,"children":162},{"class":98},[163],{"type":35,"value":164},"{\n",{"type":26,"tag":85,"props":166,"children":168},{"class":87,"line":167},5,[169,174,179,183,188,193,198,203,208,213],{"type":26,"tag":85,"props":170,"children":171},{"class":98},[172],{"type":35,"value":173},"    $user ",{"type":26,"tag":85,"props":175,"children":176},{"class":92},[177],{"type":35,"value":178},"=",{"type":26,"tag":85,"props":180,"children":181},{"class":98},[182],{"type":35,"value":101},{"type":26,"tag":85,"props":184,"children":185},{"class":104},[186],{"type":35,"value":187},"User",{"type":26,"tag":85,"props":189,"children":190},{"class":92},[191],{"type":35,"value":192},"::",{"type":26,"tag":85,"props":194,"children":195},{"class":147},[196],{"type":35,"value":197},"factory",{"type":26,"tag":85,"props":199,"children":200},{"class":98},[201],{"type":35,"value":202},"()",{"type":26,"tag":85,"props":204,"children":205},{"class":92},[206],{"type":35,"value":207},"->",{"type":26,"tag":85,"props":209,"children":210},{"class":147},[211],{"type":35,"value":212},"create",{"type":26,"tag":85,"props":214,"children":215},{"class":98},[216],{"type":35,"value":217},"([\n",{"type":26,"tag":85,"props":219,"children":221},{"class":87,"line":220},6,[222,227,233,238,242,246,251,255,259,264],{"type":26,"tag":85,"props":223,"children":224},{"class":98},[225],{"type":35,"value":226},"        ",{"type":26,"tag":85,"props":228,"children":230},{"class":229},"ct-882767",[231],{"type":35,"value":232},"'",{"type":26,"tag":85,"props":234,"children":236},{"class":235},"ct-035036",[237],{"type":35,"value":71},{"type":26,"tag":85,"props":239,"children":240},{"class":229},[241],{"type":35,"value":232},{"type":26,"tag":85,"props":243,"children":244},{"class":98},[245],{"type":35,"value":101},{"type":26,"tag":85,"props":247,"children":248},{"class":92},[249],{"type":35,"value":250},"=>",{"type":26,"tag":85,"props":252,"children":253},{"class":98},[254],{"type":35,"value":101},{"type":26,"tag":85,"props":256,"children":257},{"class":229},[258],{"type":35,"value":232},{"type":26,"tag":85,"props":260,"children":261},{"class":235},[262],{"type":35,"value":263},"admin",{"type":26,"tag":85,"props":265,"children":266},{"class":229},[267],{"type":35,"value":268},"'\n",{"type":26,"tag":85,"props":270,"children":272},{"class":87,"line":271},7,[273],{"type":26,"tag":85,"props":274,"children":275},{"class":98},[276],{"type":35,"value":277},"    ]);\n",{"type":26,"tag":85,"props":279,"children":281},{"class":87,"line":280},8,[282],{"type":26,"tag":85,"props":283,"children":284},{"class":98},[285],{"type":35,"value":286},"    \n",{"type":26,"tag":85,"props":288,"children":290},{"class":87,"line":289},9,[291,296,301,305,309,314,319,323,328,332],{"type":26,"tag":85,"props":292,"children":293},{"class":98},[294],{"type":35,"value":295},"    ",{"type":26,"tag":85,"props":297,"children":298},{"class":147},[299],{"type":35,"value":300},"session",{"type":26,"tag":85,"props":302,"children":303},{"class":98},[304],{"type":35,"value":202},{"type":26,"tag":85,"props":306,"children":307},{"class":92},[308],{"type":35,"value":207},{"type":26,"tag":85,"props":310,"children":311},{"class":147},[312],{"type":35,"value":313},"setPreviousUrl",{"type":26,"tag":85,"props":315,"children":316},{"class":98},[317],{"type":35,"value":318},"(",{"type":26,"tag":85,"props":320,"children":321},{"class":229},[322],{"type":35,"value":232},{"type":26,"tag":85,"props":324,"children":325},{"class":235},[326],{"type":35,"value":327},"/login",{"type":26,"tag":85,"props":329,"children":330},{"class":229},[331],{"type":35,"value":232},{"type":26,"tag":85,"props":333,"children":334},{"class":98},[335],{"type":35,"value":336},");\n",{"type":26,"tag":85,"props":338,"children":340},{"class":87,"line":339},10,[341],{"type":26,"tag":85,"props":342,"children":343},{"class":98},[344],{"type":35,"value":286},{"type":26,"tag":85,"props":346,"children":347},{"class":87,"line":10},[348,353,357,361,367,371,376,380,384,388,392],{"type":26,"tag":85,"props":349,"children":350},{"class":98},[351],{"type":35,"value":352},"    $response ",{"type":26,"tag":85,"props":354,"children":355},{"class":92},[356],{"type":35,"value":178},{"type":26,"tag":85,"props":358,"children":359},{"class":98},[360],{"type":35,"value":101},{"type":26,"tag":85,"props":362,"children":364},{"class":363},"ct-531775",[365],{"type":35,"value":366},"$this",{"type":26,"tag":85,"props":368,"children":369},{"class":92},[370],{"type":35,"value":207},{"type":26,"tag":85,"props":372,"children":373},{"class":147},[374],{"type":35,"value":375},"post",{"type":26,"tag":85,"props":377,"children":378},{"class":98},[379],{"type":35,"value":318},{"type":26,"tag":85,"props":381,"children":382},{"class":229},[383],{"type":35,"value":232},{"type":26,"tag":85,"props":385,"children":386},{"class":235},[387],{"type":35,"value":327},{"type":26,"tag":85,"props":389,"children":390},{"class":229},[391],{"type":35,"value":232},{"type":26,"tag":85,"props":393,"children":394},{"class":98},[395],{"type":35,"value":396},", [\n",{"type":26,"tag":85,"props":398,"children":400},{"class":87,"line":399},12,[401,405,409,414,418,422,426,431,435],{"type":26,"tag":85,"props":402,"children":403},{"class":98},[404],{"type":35,"value":226},{"type":26,"tag":85,"props":406,"children":407},{"class":229},[408],{"type":35,"value":232},{"type":26,"tag":85,"props":410,"children":411},{"class":235},[412],{"type":35,"value":413},"email",{"type":26,"tag":85,"props":415,"children":416},{"class":229},[417],{"type":35,"value":232},{"type":26,"tag":85,"props":419,"children":420},{"class":98},[421],{"type":35,"value":101},{"type":26,"tag":85,"props":423,"children":424},{"class":92},[425],{"type":35,"value":250},{"type":26,"tag":85,"props":427,"children":428},{"class":98},[429],{"type":35,"value":430}," $user",{"type":26,"tag":85,"props":432,"children":433},{"class":92},[434],{"type":35,"value":207},{"type":26,"tag":85,"props":436,"children":437},{"class":98},[438],{"type":35,"value":439},"email,\n",{"type":26,"tag":85,"props":441,"children":443},{"class":87,"line":442},13,[444,448,452,457,461,465,469,473,477,481,485],{"type":26,"tag":85,"props":445,"children":446},{"class":98},[447],{"type":35,"value":226},{"type":26,"tag":85,"props":449,"children":450},{"class":229},[451],{"type":35,"value":232},{"type":26,"tag":85,"props":453,"children":454},{"class":235},[455],{"type":35,"value":456},"password",{"type":26,"tag":85,"props":458,"children":459},{"class":229},[460],{"type":35,"value":232},{"type":26,"tag":85,"props":462,"children":463},{"class":98},[464],{"type":35,"value":101},{"type":26,"tag":85,"props":466,"children":467},{"class":92},[468],{"type":35,"value":250},{"type":26,"tag":85,"props":470,"children":471},{"class":98},[472],{"type":35,"value":101},{"type":26,"tag":85,"props":474,"children":475},{"class":229},[476],{"type":35,"value":232},{"type":26,"tag":85,"props":478,"children":479},{"class":235},[480],{"type":35,"value":456},{"type":26,"tag":85,"props":482,"children":483},{"class":229},[484],{"type":35,"value":232},{"type":26,"tag":85,"props":486,"children":487},{"class":98},[488],{"type":35,"value":489},",\n",{"type":26,"tag":85,"props":491,"children":493},{"class":87,"line":492},14,[494],{"type":26,"tag":85,"props":495,"children":496},{"class":98},[497],{"type":35,"value":277},{"type":26,"tag":85,"props":499,"children":501},{"class":87,"line":500},15,[502],{"type":26,"tag":85,"props":503,"children":504},{"class":98},[505],{"type":35,"value":286},{"type":26,"tag":85,"props":507,"children":509},{"class":87,"line":508},16,[510,515,519,524,528,533,537,541,546,550,555],{"type":26,"tag":85,"props":511,"children":512},{"class":98},[513],{"type":35,"value":514},"    $response",{"type":26,"tag":85,"props":516,"children":517},{"class":92},[518],{"type":35,"value":207},{"type":26,"tag":85,"props":520,"children":521},{"class":147},[522],{"type":35,"value":523},"assertLocation",{"type":26,"tag":85,"props":525,"children":526},{"class":98},[527],{"type":35,"value":318},{"type":26,"tag":85,"props":529,"children":530},{"class":147},[531],{"type":35,"value":532},"route",{"type":26,"tag":85,"props":534,"children":535},{"class":98},[536],{"type":35,"value":318},{"type":26,"tag":85,"props":538,"children":539},{"class":229},[540],{"type":35,"value":232},{"type":26,"tag":85,"props":542,"children":543},{"class":235},[544],{"type":35,"value":545},"admin.dashboard",{"type":26,"tag":85,"props":547,"children":548},{"class":229},[549],{"type":35,"value":232},{"type":26,"tag":85,"props":551,"children":552},{"class":98},[553],{"type":35,"value":554},")); ",{"type":26,"tag":85,"props":556,"children":557},{"class":119},[558],{"type":35,"value":559},"// admin/dashboard\n",{"type":26,"tag":85,"props":561,"children":563},{"class":87,"line":562},17,[564],{"type":26,"tag":85,"props":565,"children":566},{"class":98},[567],{"type":35,"value":568},"}",{"type":26,"tag":27,"props":570,"children":571},{},[572],{"type":26,"tag":31,"props":573,"children":574},{},[575],{"type":35,"value":576},"Code by steps",{"type":26,"tag":578,"props":579,"children":580},"ul",{},[581,597,613,624],{"type":26,"tag":582,"props":583,"children":584},"li",{},[585,587,591,593],{"type":35,"value":586},"First create a ",{"type":26,"tag":43,"props":588,"children":589},{},[590],{"type":35,"value":64},{"type":35,"value":592}," model by ",{"type":26,"tag":43,"props":594,"children":595},{},[596],{"type":35,"value":197},{"type":26,"tag":582,"props":598,"children":599},{},[600,602,606,608],{"type":35,"value":601},"Then add a ",{"type":26,"tag":43,"props":603,"children":604},{},[605],{"type":35,"value":300},{"type":35,"value":607}," to establish a current ",{"type":26,"tag":43,"props":609,"children":610},{},[611],{"type":35,"value":612},"url",{"type":26,"tag":582,"props":614,"children":615},{},[616,618,622],{"type":35,"value":617},"Then make the request to log in with data (the default password in factories is ",{"type":26,"tag":43,"props":619,"children":620},{},[621],{"type":35,"value":456},{"type":35,"value":623},")",{"type":26,"tag":582,"props":625,"children":626},{},[627,629,633,635,639,641,646],{"type":35,"value":628},"finally assert the current location, after ",{"type":26,"tag":43,"props":630,"children":631},{},[632],{"type":35,"value":54},{"type":35,"value":634}," with any ",{"type":26,"tag":43,"props":636,"children":637},{},[638],{"type":35,"value":532},{"type":35,"value":640}," as you need, if it's a ",{"type":26,"tag":43,"props":642,"children":643},{},[644],{"type":35,"value":645},"named route",{"type":35,"value":647}," probably it is better",{"type":26,"tag":27,"props":649,"children":650},{},[651],{"type":35,"value":652},"Thanks for reading!",{"type":26,"tag":654,"props":655,"children":656},"style",{},[657],{"type":35,"value":658},".dracula{color:#F8F8F2;background:#282A36;}.ct-166232{color:#FF79C6;}.ct-183901{color:#F8F8F2;}.ct-432594{color:#8BE9FD;font-style:italic;}.ct-784317{color:#6272A4;}.ct-711500{color:#50FA7B;}.ct-882767{color:#E9F284;}.ct-035036{color:#F1FA8C;}.ct-531775{color:#BD93F9;font-style:italic;}",{"title":7,"searchDepth":115,"depth":115,"links":660},[],"markdown","content:blog:11-test-redirect-after-login-by-roles-in-laravel.md","content","blog/11-test-redirect-after-login-by-roles-in-laravel.md","md",1697073120064]